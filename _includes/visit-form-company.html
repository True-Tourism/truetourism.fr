<form
        id="visit-form-company"
        class="w-full max-w-lg py-4"
        data-backend="{{ site.data.backend[jekyll.environment] }}"
>
    <div class="flex flex-wrap -mx-3 mb-6">
        <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
            <label
                    class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"
                    for="company"
            >
                {{ site.data.form.company-name }}
            </label>
            <input
                    class="appearance-none block w-full text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight text-sm focus:outline-none"
                    id="company"
                    name="company"
                    type="text"
                    placeholder="{{ site.data.form.company-name }}"
                    required
            />
        </div>
        <div class="w-full md:w-1/2 px-3">
            <label
                    class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"
                    for="email"
            >
                {{ site.data.form.contact-email }}
            </label>
            <input
                    class="appearance-none block w-full text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight text-sm focus:outline-none"
                    id="email"
                    name="_replyto"
                    type="email"
                    placeholder="{{ site.data.form.email }}"
                    required
            />
        </div>
    </div>

    <div class="flex flex-wrap -mx-3 mb-6">
        <div class="w-full md:w-1/2 px-3 mb-6 md:mb-0">
            <label
                    class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"
                    for="participants"
            >
                {{ site.data.form.participants }}
            </label>
            <input
                    class="appearance-none block w-full text-gray-700 border border-gray-200 rounded py-3 px-4 leading-tight text-sm focus:outline-none"
                    id="participants"
                    name="participants"
                    type="number"
                    placeholder="{{ site.data.form.participants }}"
                    required
                    max="20"
                    min="1"
            />
        </div>

        <div class="w-full md:w-1/2 px-3">
            <label
                    class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"
                    for="date"
            >
                {{ site.data.form.date }}
            </label>
            <input
                    class="appearance-none block w-full text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight text-sm focus:outline-none"
                    id="date"
                    name="date"
                    type="date"
                    required
                    min="{{ 'now' | date: '%Y-%m-%d' }}"
            />
        </div>
    </div>

    <div class="flex flex-wrap -mx-3 mb-6">
        <div class="w-full px-3">
            <label
                    class="block uppercase tracking-wide text-gray-700 text-xs font-bold mb-2"
                    for="message"
            >
                {{ site.data.form.message }} ({{ site.data.form.optional }})
            </label>
            <textarea
                    class="appearance-none block w-full min-h-32 text-gray-700 border border-gray-200 rounded py-3 px-4 mb-3 leading-tight text-sm focus:outline-none"
                    id="message"
                    name="message"
                    placeholder="{{ site.data.form.company-form-message-placeholder }}"
            ></textarea>
        </div>
    </div>

    <div class="flex flex-wrap mx-3 mb-6 text-center">
        <div class="w-full px-3">
            <button
                    class="bg-green-500 hover:bg-green-700 text-white text-base font-bold py-2 px-4 rounded focus:outline-none shadow-outline"
                    id="submit-visit-form-company"
                    type="submit"
            >
                Prendre contact
            </button>
        </div>
    </div>
</form>

<script defer>
  document.getElementById("submit-visit-form-company").addEventListener("click", async (event) => {
    event.preventDefault();

    const form = document.getElementById("visit-form-company");
    form.reportValidity();
    if (!form.checkValidity()) {
      return;
    }

    const backend = form.getAttribute("data-backend");

    const company = document.getElementById("company").value;
    const email = document.getElementById("email").value;
    const participants = document.getElementById("participants").value;
    const date = document.getElementById("date").value;
    const message = document.getElementById("message").value;

    const response = await fetch(`https://${backend}/v1/manual`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        name: "send_company_form",
        data: {
          company_name: company,
          email: email,
          participants: participants,
          date: date,
          message: message,
        },
      }),
    });

    if (!response.ok) {
      alert("Une erreur est survenue lors du traitement de votre demande. Veuillez réessayer plus tard.");
      return;
    }

    alert("Votre demande de contact a été transmise. Nous vous recontacterons dans les plus brefs délais.");

    form.reset();
  });
</script>